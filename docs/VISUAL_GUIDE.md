# Visual Guide

모든 시각 요소의 색상, 모양, 크기를 정리한 문서. 코드 변경 시 반드시 함께 업데이트할 것.

---

## 바이옴 색상표

| 바이옴 | 색상 | Color 값 | 이동 비용 |
|--------|------|----------|----------|
| DEEP_WATER | 진한 남색 | `Color(0.05, 0.10, 0.35)` | 통행 불가 |
| SHALLOW_WATER | 중간 파랑 | `Color(0.12, 0.30, 0.55)` | 통행 불가 |
| BEACH | 모래색 | `Color(0.85, 0.80, 0.55)` | 1.2 |
| GRASSLAND | 밝은 초록 | `Color(0.35, 0.65, 0.20)` | 1.0 |
| FOREST | 중간 초록 | `Color(0.15, 0.45, 0.10)` | 1.3 |
| DENSE_FOREST | 어두운 초록 | `Color(0.08, 0.30, 0.05)` | 1.8 |
| HILL | 갈색 | `Color(0.55, 0.50, 0.35)` | 1.5 |
| MOUNTAIN | 회갈색 | `Color(0.45, 0.42, 0.40)` | 통행 불가 |
| SNOW | 흰색 | `Color(0.90, 0.92, 0.95)` | 2.0 |

밝기는 고도(elevation)에 따라 0.7~1.3 범위로 변조됨 (`world_renderer.gd`).

---

## 에이전트 시각

### 직업별 도형 (LOD 1, 2)

| 직업 | 모양 | 크기(px) | 색상 | Color 값 |
|------|------|---------|------|----------|
| none | 원 | 3 | 회색 | `Color(0.6, 0.6, 0.6)` |
| gatherer | 원 | 4 | 밝은 초록 | `Color(0.3, 0.8, 0.2)` |
| lumberjack | 삼각형 | 5 | 갈색 | `Color(0.6, 0.35, 0.1)` |
| builder | 사각형 | 5 | 주황 | `Color(0.9, 0.6, 0.1)` |
| miner | 마름모 | 4 | 청회색 | `Color(0.5, 0.6, 0.75)` |

### 상태 표시

| 상태 | 시각 효과 | 조건 |
|------|----------|------|
| 선택됨 | 흰색 원형 테두리 (r=7px, 두께 1.5) | `entity.id == selected_entity_id` |
| 선택 + 목표 | 흰색 점선 (alpha 0.3) → 목표 좌표 | `action_target != (-1,-1)` |
| 선택 + LOD 2 | 이름 텍스트 (12px, 흰색) | `_current_lod == 2` |
| 자원 운반 중 | 머리 위 작은 점 (r=1.5px) | `get_total_carry() > 0` |
| 배고픔 위험 | 머리 위 빨간 점 (r=2px) | `hunger < 0.2` |

### 운반 표시 색상 (dominant resource)

| 자원 | 점 색상 | Color 값 |
|------|---------|----------|
| food | 연두 | `Color(0.8, 0.9, 0.2)` |
| wood | 진초록 | `Color(0.2, 0.5, 0.1)` |
| stone | 밝은 회색 | `Color(0.7, 0.7, 0.72)` |

---

## 건물 시각

### LOD 1, 2 (마을/디테일 뷰)

| 타입 | 모양 | 크기 | 채움 색상 | 테두리 색상 | 테두리 두께 |
|------|------|------|----------|-----------|-----------|
| stockpile | 사각형 | tile×0.8 | `Color(0.55, 0.35, 0.15)` | `Color(0.9, 0.7, 0.3)` | 2.0 |
| shelter | 삼각형 | tile×0.8 | `Color(0.7, 0.4, 0.2)` | `Color(1.0, 0.8, 0.4)` | 2.0 |
| campfire | 원 | r=tile×0.8×0.35 | `Color(1.0, 0.4, 0.1)` | 글로우 링 (r=tile×3, alpha×0.15) | 1.5 |

### LOD 0 (전략 뷰)

| 타입 | 모양 | 크기 | 색상 |
|------|------|------|------|
| stockpile | 사각형 | 3×3px | `Color(0.6, 0.35, 0.15)` |
| shelter | 사각형 | 3×3px | `Color(0.9, 0.55, 0.2)` |
| campfire | 사각형 | 3×3px | `Color(0.9, 0.2, 0.15)` |

### 건설 중 표시

- 전체 건물 alpha = 0.4 (완성 시 1.0)
- 진행 바: 건물 아래 2px, 폭=건물 크기
  - 배경: `Color(0.2, 0.2, 0.2, 0.6)`
  - 채움: `Color(0.2, 0.8, 0.2, 0.8)` × build_progress

### LOD 2 추가 표시

- stockpile (완성): 아래에 `F:N W:N S:N` 텍스트 (10px, 흰색)

---

## 자원 오버레이

Tab 키로 ON/OFF 토글. 100틱마다 자동 갱신.

| 자원 | 색상 | Color 값 | 투명도 범위 | 표시 조건 |
|------|------|----------|-----------|----------|
| 식량 (food) | 진한 노랑 | `Color(1.0, 0.85, 0.0)` | 0.45~0.65 | `food > 2.0` |
| 돌 (stone) | 진한 하늘색 | `Color(0.4, 0.6, 1.0)` | 0.4~0.6 | `stone > 2.0` |
| 나무 (wood) | 선명한 초록 | `Color(0.0, 0.8, 0.2)` | 0.35~0.55 | `wood > 3.0` |

우선순위: food > stone > wood (한 타일에 여러 자원이면 높은 우선순위만 표시)

투명도 계산:
- food: `clamp(food / 8.0, 0.45, 0.65)`
- stone: `clamp(stone / 8.0, 0.4, 0.6)`
- wood: `clamp(wood / 10.0, 0.35, 0.55)`

### LOD 2 문자 마커 (줌 인 시)

자원 오버레이 ON + LOD 2 (zoom > 4.2)일 때 타일 위에 1글자 마커 표시:

| 자원 | 문자 | 색상 | 폰트 크기 | 표시 조건 |
|------|------|------|----------|----------|
| food | F | 노랑 `Color(1.0, 1.0, 0.0)` | 8px | `food > 2.0` |
| wood | W | 초록 `Color(0.0, 1.0, 0.0)` | 8px | `wood > 3.0` |
| stone | S | 하늘 `Color(0.5, 0.7, 1.0)` | 8px | `stone > 2.0` |

처리 위치: `entity_renderer.gd` (`resource_overlay_visible` 플래그)

---

## 줌 레벨별 표시 (LOD)

히스테리시스 적용으로 경계에서 깜빡임 방지.

| LOD | 줌 진입 | 줌 이탈 | 에이전트 | 건물 |
|-----|---------|---------|---------|------|
| 0 (전략) | zoom < 1.3 | zoom > 1.7 → LOD 1 | 표시 안 함 | 3px 색상 블록 + 정착지 라벨 ("S{id}: {pop}") |
| 1 (마을) | 1.3~4.2 | < 1.3 → LOD 0, > 4.2 → LOD 2 | 직업별 도형 + 운반/배고픔 표시 | 도형 + 테두리 + 건설 진행 바 |
| 2 (디테일) | zoom > 4.2 | zoom < 3.8 → LOD 1 | 도형 + 선택 시 이름 | 도형 + stockpile 저장량 텍스트 |

뷰포트 컬링: 모든 렌더러(Entity, Building)가 카메라 시야 밖 타일은 스킵.

---

## HUD 레이아웃

### 상단 바 (검정 반투명 0.6, 높이 24px):
```
▶ 5x │ Y3 D45 12:00 │ Pop:137 │ F:340 W:2100 S:450 │ Bld:39 │ FPS:60
```

자원은 색상 코딩: F=초록, W=갈색, S=회색. 정착지 정보 제거 → 미니맵으로 이동.

### 좌하단 엔티티 패널 (320×280px, 선택 시):
- 직업 색상 원 + 이름 (14px)
- 직업 | 정착지 | 나이
- 행동 + 목표 좌표 + 경로 스텝
- 인벤토리 (색상 코딩 F/W/S)
- 욕구 바 + 퍼센트 (배고픔=빨강, 에너지=노랑, 소셜=파랑)
- 배고픔 < 20% 시 빨간 바 깜빡임
- "E: Details" 힌트 텍스트 (하단, 회색)

### 좌하단 건물 패널 (320×190px, 건물 선택 시):
- 건물 아이콘 + 이름 + 위치 + 정착지
- stockpile: 저장 자원 (F/W/S)
- shelter: "Housing: energy regen"
- campfire: "Warmth: social bonus"
- "E: Details" 힌트 텍스트 (하단, 회색)

### 우상단 미니맵 (160×160px, M 토글):
- 바이옴 색상 Image 기반, 20틱마다 갱신
- 건물 마커 (3×3px): stockpile=노랑, shelter=주황, campfire=빨강
- 에이전트 마커 (1px): gatherer=초록, lumberjack=갈색, builder=주황, miner=하늘
- 카메라 시야 흰색 사각형
- 정착지 이름 라벨
- 좌클릭 → 카메라 이동

### 통계 패널 (160×200px, 미니맵 하단, G 토글):
- 인구 그래프: 초록 polyline (`Color(0.2, 1.0, 0.4)`)
- 자원 그래프: food=노랑, wood=갈색, stone=회색
- 직업 분포 바: gatherer=초록, lumberjack=갈색, builder=주황, miner=하늘

### 토스트 알림 (좌측, 최대 5개):
- 4초 표시, 마지막 1초 페이드아웃, 32px 간격
- 위치: 좌측 x=20, 상단 바 아래 y=40부터
- PanelContainer 배경 바 (14px 폰트):
  - 성장/출생/마일스톤: 초록 `Color(0.1, 0.4, 0.1, 0.9)`
  - 건설 완료: 갈색 `Color(0.4, 0.3, 0.1, 0.9)`
  - 위험/아사: 빨강 `Color(0.5, 0.1, 0.1, 0.9)`
  - 일반 (save/load): 회색 `Color(0.2, 0.2, 0.2, 0.9)`
- 인구 마일스톤: 10명 단위 (10/20/30...)
- 시작 시 "WorldSim started! Pop: N" 토스트 1개

### 도움말 오버레이 (H 토글, 자동 일시정지):
- 600×440px PanelContainer, 화면 중앙
- 배경: `Color(0.08, 0.08, 0.12, 0.95)` 둥근 모서리 8px
- 제목: 24px "WorldSim Controls"
- 두 컬럼 레이아웃 (Camera/Game, Panels/Display)
- 섹션 헤더: 16px, 항목: 13px
- H 열면 자동 일시정지, 닫으면 재개

### 자원 범례 (좌상단, Tab 오버레이 시):
- Food `Color(1.0, 0.85, 0.0)` / Wood `Color(0.0, 0.8, 0.2)` / Stone `Color(0.4, 0.6, 1.0)`

### 우하단 키 힌트:
- 10px 회색 텍스트 (`Color(0.5, 0.5, 0.5, 0.6)`)
- `⌘S:Save  ⌘L:Load  Tab:Resources  M:Map  G:Stats  E:Details  N:Day/Night  H:Help  Space:Pause`

### 통계 상세 패널 (G 키, 화면 중앙):
- 화면의 75%×80% 크기, 중앙 정렬
- 배경: `Color(0.05, 0.05, 0.1, 0.95)` 둥근 모서리 12px
- dim 오버레이: `Color(0, 0, 0, 0.5)` 전체 화면
- 자동 일시정지, G/Esc로 닫기
- 인구 그래프 (초록 polyline, 피크/사망/출생 통계)
- 자원 그래프 (3색 선, 100틱당 변화량)
- 직업 분포 바 (% 표시)
- 정착지 비교 (인구, 건물 수)

### 에이전트 상세 패널 (E 키, 에이전트 선택 시):
- 화면의 50%×65% 크기, 중앙 정렬
- 헤더: 직업 색상 원 + 이름 + 정착지
- 상태: 행동, 경로, 인벤토리
- 욕구 바 (hunger/energy/social)
- 통계: speed, strength, total_gathered, buildings_built
- 최근 행동 히스토리 (최대 20개)

### 건물 상세 패널 (E 키, 건물 선택 시):
- 화면의 45%×50% 크기, 중앙 정렬
- 헤더: 건물 타입 아이콘 + 이름 + 위치
- 정착지, 건설 상태/진행률
- 타입별 상세: stockpile 저장량, shelter/campfire 효과
- 건설 비용 정보

---

## 낮/밤 사이클

WorldRenderer의 modulate를 게임 시간(hour)에 따라 **느린 보간(lerp)**으로 변경.
N 키로 ON/OFF 토글 가능 (OFF 시 항상 `Color(1, 1, 1)`).

| 시간대 | 색상 | Color 값 | 비고 |
|--------|------|----------|------|
| 5 (여명) | 거의 밝음 | `Color(0.9, 0.9, 0.95)` | |
| 6~17 (낮) | 흰색 | `Color(1.0, 1.0, 1.0)` | 기본 |
| 18 (석양) | 아주 미세 | `Color(0.95, 0.9, 0.85)` | |
| 19 (황혼) | 붉은 회색 | `Color(0.85, 0.82, 0.88)` | |
| 그 외 (밤) | 약간 어둡게 | `Color(0.75, 0.75, 0.85)` | 이전보다 밝게 |

### 보간 속도
- 기본: `lerp_speed = 0.3 * delta` (매우 느리게)
- 고속 (speed_index >= 3): `lerp_speed = 0.05 * delta` (깜빡임 방지)
- `_current_day_color.lerp(target_color, minf(lerp_speed, 1.0))`
